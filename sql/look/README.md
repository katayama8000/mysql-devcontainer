MySQLロック機能のテスト方法
このガイドでは、MySQLにおける行レベルのロックがどのように機能するかを、段階的に説明します。このテストを実行するには、2つの異なるMySQLコマンドラインセッションを同時に使用する必要があります。

ステップ1: 2つのMySQLセッションを開く
2つの別々のターミナルウィンドウを開き、それぞれでMySQLデータベースに接続してください。

```bash
mysql -h mysql -u root -ppassword mydatabase
```

ステップ2: セッション1での実行（行のロック）
最初のセッションで、以下のコマンドを順番に実行します。これにより、usersテーブルのid = 1の行に排他ロックがかけられます。このロックは、トランザクションがコミットまたはロールバックされるまで、他のセッションがこの行を変更するのを防ぎます。

```sql
USE mydatabase;
START TRANSACTION;
SELECT * FROM users WHERE id = 1 FOR UPDATE;
```


ステップ3: セッション2での実行（ロックされた行の更新を試みる）
次に、2番目のセッションに切り替え、同じ行を更新しようとします。このコマンドは、セッション1がロックを解除するまで待機状態になります。ターミナルのプロンプトがすぐに戻ってこないことを確認してください。

```sql
USE mydatabase;
UPDATE users SET name = '新しい名前' WHERE id = 1;
``` 


ステップ4: セッション1での完了（ロックの解除）
セッション1に戻り、COMMIT;を実行します。これにより、トランザクションが完了し、ロックが解除されます。

```
COMMIT;
```


ロックが解除されるとすぐに、セッション2のUPDATEコマンドが正常に完了します。

ステップ5: 変更の確認
最後に、usersテーブルを確認して、セッション2で行われた変更が適用されたことを確認します。

```sql
SELECT * FROM users WHERE id = 1;
```
